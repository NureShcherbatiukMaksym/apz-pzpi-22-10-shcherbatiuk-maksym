{"ast":null,"code":"var _jsxFileName = \"D:\\\\Program Files\\\\WebstormProjects\\\\soil_scout\\\\web\\\\src\\\\utils\\\\PrivateRoute.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { UserContext } from '../contexts/UserContext';\nimport api from '../utils/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children\n}) => {\n  _s();\n  const {\n    user,\n    isAdmin,\n    hasDevice,\n    loading\n  } = useContext(UserContext);\n  const [errorMessage, setErrorMessage] = useState('');\n  useEffect(() => {\n    // Перевірка, чи є користувач\n    const checkUser = async () => {\n      try {\n        // Якщо немає користувача, відразу виводимо помилку\n        if (!user) {\n          setErrorMessage('Користувач не авторизований');\n          return;\n        }\n\n        // Перевіряємо, чи є пристрій\n        if (!hasDevice) {\n          setErrorMessage('Ви не маєте пристроїв. Придбайте пристрій, щоб продовжити.');\n          return;\n        }\n\n        // Якщо все ок, очищаємо повідомлення про помилку\n        setErrorMessage('');\n      } catch (err) {\n        console.error('Помилка при перевірці користувача або пристроїв:', err);\n        setErrorMessage('Сталася помилка при перевірці даних користувача');\n      }\n    };\n    checkUser();\n  }, [user, hasDevice]);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0435\\u043D\\u043D\\u044F...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 37,\n    columnNumber: 25\n  }, this); // Показуємо індикатор поки завантажуються дані\n\n  // Логіка: якщо є помилка, то показуємо її\n  if (errorMessage) {\n    console.log(errorMessage); // Логуємо повідомлення\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: errorMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 16\n    }, this);\n  }\n\n  // Якщо користувач не авторизований, або не має пристроїв, перенаправляємо на відповідну сторінку\n  if (!user) {\n    console.log('Перенаправлення на логін: Користувач не авторизований');\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 16\n    }, this);\n  }\n  if (!hasDevice) {\n    console.log('Перенаправлення на купівлю пристрою: У користувача немає пристроїв');\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/buy-device\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 16\n    }, this);\n  }\n\n  // Якщо всі умови виконуються, дозволяємо доступ до сторінки\n  console.log('Користувач успішно пройшов перевірку');\n  return children;\n};\n_s(ProtectedRoute, \"ti1AIhy8V9RbAKLio7aeQcTcatw=\");\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","useContext","useEffect","useState","Navigate","UserContext","api","jsxDEV","_jsxDEV","ProtectedRoute","children","_s","user","isAdmin","hasDevice","loading","errorMessage","setErrorMessage","checkUser","err","console","error","fileName","_jsxFileName","lineNumber","columnNumber","log","to","replace","_c","$RefreshReg$"],"sources":["D:/Program Files/WebstormProjects/soil_scout/web/src/utils/PrivateRoute.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\nimport { UserContext } from '../contexts/UserContext';\r\nimport api from '../utils/api';\r\n\r\nconst ProtectedRoute = ({ children }) => {\r\n    const { user, isAdmin, hasDevice, loading } = useContext(UserContext);\r\n    const [errorMessage, setErrorMessage] = useState('');\r\n\r\n    useEffect(() => {\r\n        // Перевірка, чи є користувач\r\n        const checkUser = async () => {\r\n            try {\r\n                // Якщо немає користувача, відразу виводимо помилку\r\n                if (!user) {\r\n                    setErrorMessage('Користувач не авторизований');\r\n                    return;\r\n                }\r\n\r\n                // Перевіряємо, чи є пристрій\r\n                if (!hasDevice) {\r\n                    setErrorMessage('Ви не маєте пристроїв. Придбайте пристрій, щоб продовжити.');\r\n                    return;\r\n                }\r\n\r\n                // Якщо все ок, очищаємо повідомлення про помилку\r\n                setErrorMessage('');\r\n            } catch (err) {\r\n                console.error('Помилка при перевірці користувача або пристроїв:', err);\r\n                setErrorMessage('Сталася помилка при перевірці даних користувача');\r\n            }\r\n        };\r\n\r\n        checkUser();\r\n    }, [user, hasDevice]);\r\n\r\n    if (loading) return <div>Завантаження...</div>; // Показуємо індикатор поки завантажуються дані\r\n\r\n    // Логіка: якщо є помилка, то показуємо її\r\n    if (errorMessage) {\r\n        console.log(errorMessage); // Логуємо повідомлення\r\n        return <div>{errorMessage}</div>;\r\n    }\r\n\r\n    // Якщо користувач не авторизований, або не має пристроїв, перенаправляємо на відповідну сторінку\r\n    if (!user) {\r\n        console.log('Перенаправлення на логін: Користувач не авторизований');\r\n        return <Navigate to=\"/login\" replace />;\r\n    }\r\n\r\n    if (!hasDevice) {\r\n        console.log('Перенаправлення на купівлю пристрою: У користувача немає пристроїв');\r\n        return <Navigate to=\"/buy-device\" replace />;\r\n    }\r\n\r\n    // Якщо всі умови виконуються, дозволяємо доступ до сторінки\r\n    console.log('Користувач успішно пройшов перевірку');\r\n    return children;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC9D,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,SAASC,WAAW,QAAQ,yBAAyB;AACrD,OAAOC,GAAG,MAAM,cAAc;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/B,MAAMC,cAAc,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EACrC,MAAM;IAAEC,IAAI;IAAEC,OAAO;IAAEC,SAAS;IAAEC;EAAQ,CAAC,GAAGd,UAAU,CAACI,WAAW,CAAC;EACrE,MAAM,CAACW,YAAY,EAAEC,eAAe,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC;EAEpDD,SAAS,CAAC,MAAM;IACZ;IACA,MAAMgB,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC1B,IAAI;QACA;QACA,IAAI,CAACN,IAAI,EAAE;UACPK,eAAe,CAAC,6BAA6B,CAAC;UAC9C;QACJ;;QAEA;QACA,IAAI,CAACH,SAAS,EAAE;UACZG,eAAe,CAAC,4DAA4D,CAAC;UAC7E;QACJ;;QAEA;QACAA,eAAe,CAAC,EAAE,CAAC;MACvB,CAAC,CAAC,OAAOE,GAAG,EAAE;QACVC,OAAO,CAACC,KAAK,CAAC,kDAAkD,EAAEF,GAAG,CAAC;QACtEF,eAAe,CAAC,iDAAiD,CAAC;MACtE;IACJ,CAAC;IAEDC,SAAS,CAAC,CAAC;EACf,CAAC,EAAE,CAACN,IAAI,EAAEE,SAAS,CAAC,CAAC;EAErB,IAAIC,OAAO,EAAE,oBAAOP,OAAA;IAAAE,QAAA,EAAK;EAAe;IAAAY,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAK,CAAC,CAAC,CAAC;;EAEhD;EACA,IAAIT,YAAY,EAAE;IACdI,OAAO,CAACM,GAAG,CAACV,YAAY,CAAC,CAAC,CAAC;IAC3B,oBAAOR,OAAA;MAAAE,QAAA,EAAMM;IAAY;MAAAM,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC;EACpC;;EAEA;EACA,IAAI,CAACb,IAAI,EAAE;IACPQ,OAAO,CAACM,GAAG,CAAC,uDAAuD,CAAC;IACpE,oBAAOlB,OAAA,CAACJ,QAAQ;MAACuB,EAAE,EAAC,QAAQ;MAACC,OAAO;IAAA;MAAAN,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAC3C;EAEA,IAAI,CAACX,SAAS,EAAE;IACZM,OAAO,CAACM,GAAG,CAAC,oEAAoE,CAAC;IACjF,oBAAOlB,OAAA,CAACJ,QAAQ;MAACuB,EAAE,EAAC,aAAa;MAACC,OAAO;IAAA;MAAAN,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAChD;;EAEA;EACAL,OAAO,CAACM,GAAG,CAAC,sCAAsC,CAAC;EACnD,OAAOhB,QAAQ;AACnB,CAAC;AAACC,EAAA,CArDIF,cAAc;AAAAoB,EAAA,GAAdpB,cAAc;AAuDpB,eAAeA,cAAc;AAAC,IAAAoB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}